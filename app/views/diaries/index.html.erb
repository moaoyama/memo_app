<div class="page-container">
  <div class ="page-header">
    <p class="index-title">Log</p>
    <%= link_to "メモを書く", new_diary_path, class: "btn-large" %>
  </div>

  <div class="align-right-wrapper">
    <%= form_with url: diaries_path, method: :get, local: true, html: { class: "diary-search-form" } do |form| %>
      <%= form.text_field :q, value: params[:q], placeholder: "検索ワード", class: "search-input" %>
      <%= form.submit "検索" %>
    <% end %>
  </div>

  <div class="align-right-wrapper">
    <%= form_with url: diaries_path, method: :get, local: true, html: { class: "diary-filter-form" } do |form| %>
      <div class="category-select-wrapper">
        <%= form.collection_select :category_id, @categories, :id, :name, include_blank: "すべてのカテゴリ", selected: params[:category_id], class: "category-select" %>
      </div>
      <%= form.submit "検索" %>
    <% end %>
  </div>

  <div class="align-right-wrapper">
    <% if params[:q].present? || params[:category_id].present? %>
      <%= link_to "リセット", diaries_path, class: "btn-tag reset" %>
    <% end %>
  </div>

  <% if @diaries.any? %>
    <!-- 通常の一覧表示 -->
    <div id="diaries">
      <% @diaries.each do |diary| %>

        <div class="diary-item">
          <%= render partial: "diary", locals: { diary: diary } %>
        </div>       

      <% end %>
    </div>
  <% else %>
    <% if params[:q].present? %>
      <div class="empty-state">
        <p>該当するメモは見つかりませんでした</p>
        <p>別のキーワードで検索してみてください</p>
      </div>
    <% else %>
      <div class="empty-state">
        <p>まだメモがありません</p>
        <p>右上の「メモを書く」ボタンからメモを書くことができます</p>
      </div>
    <% end %>
  <% end %>

  <div class="pagination">
    <%= raw pagy_nav(@pagy) %>
  </div>

</div>